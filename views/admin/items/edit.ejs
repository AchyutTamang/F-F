
<div class="container mx-auto px-4 py-8">
    <h1 class="text-2xl font-bold mb-6">Edit Item</h1>

    <form action="/admin/items/<%= item._id %>?_method=PUT" 
          method="POST" 
          enctype="multipart/form-data"
          class="max-w-lg"
          id="itemForm">
        
        <div class="mb-4">
            <label class="block text-gray-700 mb-2" for="name">Name</label>
            <input type="text" 
                   id="name" 
                   name="name" 
                   value="<%= item.name %>"
                   class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2"
                   required>
        </div>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2" for="description">Description</label>
            <textarea id="description" 
                      name="description"
                      class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2"
                      required><%= item.description %></textarea>
        </div>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2" for="price">Price</label>
            <input type="number" 
                   id="price" 
                   name="price" 
                     min="0"
                     
                   value="<%= item.price %>"
                   class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2"
                   required>
        </div>
        <div class="mb-4">
            <label class="block text-gray-700 mb-2" for="price">Is Available</label>
            <select id="isAvailable" 
                    name="isAvailable"
                    class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2"
                    required>
                <option value="true" <%= item.isAvailable ? 'selected' : '' %>>Yes</option>
                <option value="false" <%= !item.isAvailable ? 'selected' : '' %>>No</option>
            </select>
        </div>

        <% if (item.category == "merch") { %>
          
        <% }else{ %>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2" for="category">Category</label>
            <select id="category" 
                    name="category"
                    class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2"
                    required>
                    
            </select>
        </div>

        <% } %>
        <div class="mb-4">
            <label class="block text-gray-700 mb-2" for="image">Image</label>
            <input type="file" 
                   id="image" 
                   name="image"
                   accept="image/*"
                   class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2">
            <% if (item.image) { %>
                <img src="<%= item.image %>" 
                     alt="<%= item.name %>"
                     class="mt-2 w-32 h-32 object-cover rounded">
            <% } %>
        </div>

        <button type="submit"
                class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
            Update Item
        </button>
    </form>
</div>
<% let cat =  item.category %>
<script>
    document.addEventListener("DOMContentLoaded", function () {
    
    loadCategories();
  });
      // Fetch categories when page loads
  async function loadCategories() {
    try {
      const response = await fetch("/menu/getCategories");
      const categories = await response.json();

      const categorySelect = document.getElementById("category");

      
      // Keep the "All Categories" option and add fetched categories
      categorySelect.innerHTML = `
            ${categories
              .map(
                (category) => `
                <option value="${category.value}"  >
                    ${category.value}
                </option>
            `
              )
              .join("")}
        `;
    } catch (error) {
      console.error("Error loading categories:", error);
    }
  }
document.getElementById('itemForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const name = document.getElementById('name').value.trim();
    const price = document.getElementById('price').value;
    const description = document.getElementById('description').value.trim();
    
    if (name.length < 2) {
        alert('Name must be at least 2 characters long');
        return;
    }
    
    if (price <= 0) {
        alert('Price must be greater than 0');
        return;
    }
    
  
    
    this.submit();
});
</script>

